#### Decisions to become Outlaw Government & Return to Feudalism ####
###by raged (dont hate my shit coding)

become_criminal_government_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_prison.dds" ##probably placeholder until we get artwork done
	
	desc = become_criminal_government_decision_desc
	selection_tooltip = become_criminal_government_decision_tooltip
	major = yes

	ai_check_interval = 100

	is_shown = {
		government_has_flag = government_is_feudal
		highest_held_title_tier <= tier_duchy

		OR = {
			has_trait = gallowsbait
			has_trait = peasant_leader
			has_trait = bastard
			has_trait = denounced
			has_trait = murderer
			has_trait = excommunicated
			has_trait = reaver
			has_trait = kinslayer
			has_trait = lunatic
			has_trait = viking
		}

		custom_tooltip = {
			text = recent_conversion_to_criminal_government
			NOT = { has_character_flag = just_converted_to_criminal_government }
		}
	}

	is_valid = {
		OR = {
			has_title = title:d_defias_brotherhood
			has_title = title:d_syndicate
			has_title = title:d_blackwater_raiders
			has_title = title:d_bloodsail_buccaneers
			has_title = title:d_northsea_freebooters
			has_title = title:d_southsea_freebooters
			has_title = title:e_pirate_empire
			has_title = title:k_bloodsail
			has_title = title:k_freebooter
			has_title = title:k_blackwater
			NOT = { highest_held_title_tier > tier_county }
		}
		
		OR = {
			has_trait = gallowsbait
			has_trait = peasant_leader
			has_trait = bastard
			has_trait = denounced
			has_trait = murderer
			has_trait = excommunicated
			has_trait = reaver
			has_trait = kinslayer
			has_trait = lunatic
			has_trait = viking
			has_trait = greedy
			has_trait = sadistic
			has_trait = callous
			has_trait = arbitrary
		}
		
		NOR = {
			has_trait = compassionate
			has_trait = just
		}

		AND = {
			realm_size < 5
			prestige >= 500
		}

	}

	is_valid_showing_failures_only = {
		NOT = { exists = involved_activity }
		is_imprisoned = no
		is_incapable = no
	}

	effect = {
		change_criminal_government_effect = yes
		add_realm_law_skip_effects = criminal_authority_3
		add_prestige_level = -5
		# trigger_event = wc.criminal.event.001
		
		hidden_effect = {
			add_character_flag = {
				flag = just_converted_to_criminal_government
				years = 5
			}
			##removes laws
			if = {
				limit = { has_realm_law = crown_authority_0 }
				remove_realm_law = crown_authority_0
				add_realm_law = criminal_authority_3
			}
			if = {
				limit = { has_realm_law = crown_authority_1 }
				remove_realm_law = crown_authority_1
				add_realm_law = criminal_authority_3
			}
			if = {
				limit = { has_realm_law = crown_authority_2 }
				remove_realm_law = crown_authority_2
				add_realm_law = criminal_authority_3
			}
			if = {
				limit = { has_realm_law = crown_authority_3 }
				remove_realm_law = crown_authority_3
				add_realm_law = criminal_authority_3
			}
		}
	}
	
	cost = {
		gold = 200
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

## Revert back

stop_being_criminal_government_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_prison.dds" ##probably placeholder until we get artwork done

	major = yes
	desc = stop_being_criminal_government_decision_desc

	ai_check_interval = 100

	is_shown = {
		has_government = criminal_government
	}

	is_valid = {
		has_government = criminal_government
	}

	cost = {
		gold = 1000 ##placeholder for discussion
		prestige = 5000 ##placeholder for discussion
	}

	effect = {
		change_government = feudal_government
		check_available_laws_effect = yes

		if = {
			limit = { has_realm_law = criminal_authority_0 }
			remove_realm_law = criminal_authority_0
			
		}
		if = {
			limit = { has_realm_law = criminal_authority_1 }
			remove_realm_law = criminal_authority_1
			
		}
		if = {
			limit = { has_realm_law = criminal_authority_2 }
			remove_realm_law = criminal_authority_2
			
		}
		if = {
			limit = { has_realm_law = criminal_authority_3 }
			remove_realm_law = criminal_authority_3
			
		}
		if = {
			limit = { has_realm_law = criminal_authority_4 }
			remove_realm_law = criminal_authority_4
			
		}
		if = {
			limit = { has_realm_law = criminal_authority_5 }
			remove_realm_law = criminal_authority_5
		}
		if = {
			limit = { has_realm_law = criminal_authority_6 }
			remove_realm_law = criminal_authority_6
		}

		add_realm_law = crown_authority_0

	}

	ai_will_do = {
		base = 100
	}
}