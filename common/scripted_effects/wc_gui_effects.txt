clear_this_union_variables_effect = {
	remove_variable = gui_this_union_name
	remove_variable = gui_union
	remove_variable = gui_this_union_leader
	remove_variable = gui_this_union_heir
	clear_variable_list = gui_candidates
	remove_variable = gui_this_union_strength
	remove_variable = gui_this_union_member_number
	remove_variable = pre_chosen_union
}
get_this_union_variables_effect = {
	# Union leader
	remove_variable = gui_this_union_leader
	remove_variable = gui_this_union_heir
	clear_variable_list = gui_candidates
	
	set_variable = { name = gui_this_union_leader value = scope:this_union.story_owner }
	# Union heir
	if = {
		limit = { exists = scope:this_union.story_owner.primary_heir }
		set_variable = { name = gui_this_union_heir value = scope:this_union.story_owner.primary_heir }
	}
	else = { set_variable = { name = gui_this_union_heir value = scope:this_union.story_owner } }
	
	# Union vice
	scope:this_union = {
		if = {
			limit = {
				exists = story_owner.primary_heir
				story_owner.primary_heir = {
					OR = {
						NOT = { has_variable = this_union }
						var:this_union = prev.story_owner.var:this_union
					}
					trigger_if = {
						limit = { is_ruler = yes is_independent_ruler = no }
						top_liege.highest_held_title_tier <= prev.story_owner.highest_held_title_tier
					}
				}
			}
			story_owner.primary_heir = {
				set_variable = { name = temp_union value = prev.var:this_union days = 180 }
			}
			root = {
				add_to_variable_list = {
					name = gui_candidates
					target = prev.story_owner.primary_heir
				}
			}
		}
		every_in_list = {
			variable = union_members
			limit = {
				NOT = { this = prev.story_owner }
				can_lead_union_trigger = { landless = no }
			}
			root = {
				add_to_variable_list = {
					name = gui_candidates
					target = prev
				}
			}
		}
	}
	#Union military
	set_variable = { name = gui_this_union_strength value = 0 }
	set_variable = { name = gui_this_union_member_number value = 0 }
	# Members
	scope:this_union = {
		every_in_list = {
			variable = union_members
			# Strength
			root = {
				change_variable = { name = gui_this_union_strength add = prev.max_military_strength }
				change_variable = { name = gui_this_union_member_number add = 1 }
			}
		}
	}
}

get_crisis_title_gui_effect = {
	if = {
		limit = { exists = $TITLE$.holder }
		set_variable = {
			name = crisis_character
			value = $TITLE$.holder
		}
	}
	if = {
		limit = { exists = $TITLE$ }
		set_variable = {
			name = crisis_title
			value = $TITLE$
		}
	}
	
	if = {
		limit = {
			exists = var:crisis_character
			exists = var:coalition_members
		}
		var:crisis_character = {
			every_in_list = {
				variable = coalition_members
			}
		}
	}
}
clear_crisis_gui_effect = {
	remove_variable = crisis_character
	remove_variable = crisis_title
}

get_crisis_title_gui_effect = {
	if = {
		limit = { exists = $TITLE$.holder }
		set_variable = {
			name = crisis_character
			value = $TITLE$.holder
		}
	}
	if = {
		limit = { exists = $TITLE$ }
		set_variable = {
			name = crisis_title
			value = $TITLE$
		}
	}
	
	if = {
		limit = {
			exists = var:crisis_character
			exists = var:coalition_members
		}
		var:crisis_character = {
			every_in_list = {
				variable = coalition_members
			}
		}
	}
}
clear_crisis_gui_effect = {
	remove_variable = crisis_character
	remove_variable = crisis_title
}