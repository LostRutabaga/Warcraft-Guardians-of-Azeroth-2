is_eligible_for_suramar_events_trigger = {
    exists = title:k_suramar.holder
    is_in_suramar_trigger = yes
    is_available_adult = yes
    is_landed = yes
}

has_any_possible_wretched_elves_trigger = {
    trigger_if = {
        limit = {
            has_variable_list = suramar_exiled_characters
        }
        any_in_list = {
            variable = suramar_exiled_characters
            is_alive = yes 
            can_become_wretched_trigger = yes
        }
    }
}

has_any_wretched_elves_trigger = {
    trigger_if = {
        limit = {
            has_variable_list = suramar_exiled_characters
        }
        any_in_list = {
            variable = suramar_exiled_characters
            is_alive = yes 
            has_trait = wretched
        }
    }
}

has_any_wretched_or_possible_elves_wandering_trigger = {
    trigger_if = {
        limit = {
            has_variable_list = suramar_exiled_characters
        }
        any_in_list = {
            variable = suramar_exiled_characters
            is_alive = yes 
            OR = {
                can_become_wretched_trigger = yes
                has_trait = wretched
            }
            NOR = { 
                exists = employer
                has_character_flag = suramar_refugee
            }
            is_landed = no
            is_landless_adventurer = no
        }
    }
}

can_lower_suramar_barrier_trigger = {
    custom_tooltip = {
        text = lower_suramar_barrier_decision_trigger
        OR = {
            has_character_flag = had_outsider_event
            has_character_flag = had_suramar_legion_event
        }
    }
    #TODO_WARCRAFT add more features for legion 3rd invasion
    #TODO_WARCRAFT hook in for scourge nearby?
    trigger_if = {
        limit = {
            is_ai = yes
        }
        current_date >= 615.1.1
    }
    trigger_else = {
        always = yes 
    }
}
can_restore_arcandor_trigger = {
    OR = {
        custom_tooltip = {
            text = restore_arcandor_decision_trigger
            OR = {
                has_character_flag = had_nightfallen_event
                has_character_flag = had_faldorei_event
            }
        }
        has_trait = wretched
        has_trait = creature_faldorei
    }
    OR = {
        has_arcandor_seed_trigger = yes 
        learning >= very_high_skill_rating
        prestige_level >= 3
        OR = {
            has_trait = magic_good_1
            has_trait = magic_good_2
            has_trait = magic_good_3
        }
    }
    trigger_if = {
        limit = {
            NOT = { title:c_meredil.holder = root }
        }
        title:c_meredil.holder = {
            opinion = {
                target = root
                value > low_positive_opinion
            }
        }
    }
    completely_controls = title:c_meredil
}
has_arcandor_seed_trigger = {
    custom_tooltip = {
        text = has_arcandor_seed_trigger_tt
        any_artifact = {
            artifact_owner = root 
            has_variable = arcandor_seed
        }
    }
}
can_become_wretched_trigger = {
    NOR = { 
        has_trait = wretched
        has_trait = creature_faldorei
        has_global_variable = arcandor_restored_global_variable
    }
    has_trait_with_flag = elven_family
}