first_contact_procedure_effect = {
    switch = {
        trigger = flag:$NATION$
        flag:suramar = {
            title:k_suramar.holder = { save_scope_as = reciever }
        }
    }

    switch = {
        trigger = flag:$METHOD$
        flag:letter = {
            custom_tooltip = first_contact_letter_method
            root = { save_scope_as = sender }
            save_scope_value_as = { name = first_contact_nation = flag:suramar }
            scope:reciever = {
                trigger_event = {
                    id = wc_first_contact_events.0001 
                    days = { 5 20 }
                }
            }
        }
        flag:letter = {
            custom_tooltip = first_contact_self_method
        }
    }

    switch = {
        trigger = flag:$STANCE$
        flag:friendly = {
            send_friendly_stance_effect = { TARGET = scope:reciever ORDER = first }
        }
        flag:neutral = {
            send_neutral_stance_effect = { TARGET = scope:reciever ORDER = first }
        }
        flag:hostile = {
            send_hostile_stance_effect = { TARGET = scope:reciever ORDER = first }
        }
    }
}

send_friendly_stance_effect = {
    $TARGET$ = { save_scope_as = sender }
    custom_tooltip = first_contact_friendly_effects_sender
    if = {
        limit = {
            flag:$ORDER$ = flag:first
            NOT = {
                first_contact_friendly_stance_of_reverse_trigger = { target = scope:sender }
            }
        }
        custom_tooltip = first_contact_friendly_effects_reciever
    }
    add_opinion = {
        target = scope:sender
        modifier = good_first_contact_opinion
    }
}

send_neutral_stance_effect = {
    $TARGET$ = { save_scope_as = sender }
    custom_tooltip = first_contact_neutral_effects_sender
    if = {
        limit = {
            flag:$ORDER$ = flag:first
            NOT = {
                first_contact_neutral_stance_of_reverse_trigger = { target = scope:sender }
            }
        }
        custom_tooltip = first_contact_neutral_effects_reciever
    }
    add_opinion = {
        target = scope:sender
        modifier = neutral_first_contact_opinion
    }
}

send_hostile_stance_effect = {
    $TARGET$ = { save_scope_as = sender }
    custom_tooltip = first_contact_hostile_effects_sender
    if = {
        limit = {
            flag:$ORDER$ = flag:first
            NOT = {
                first_contact_hostile_stance_of_reverse_trigger = { target = scope:sender }
            }
        }
        custom_tooltip = first_contact_hostile_effects_reciever
    }
    add_opinion = {
        target = scope:sender
        modifier = bad_first_contact_opinion
    }
}

reveal_suramar_unisolation_effect = {
    set_global_variable = suramar_barrier_lowered_variable
    title:k_suramar.holder = { 
        trigger_event = { 
            id = isolation.3 
        }
    }
    every_ruler = { 
        limit = {
            NOT = { this = title:k_suramar.holder }
        }
        trigger_event = { 
            id = isolation.3 days = { 1 60 }
        }
    }
}